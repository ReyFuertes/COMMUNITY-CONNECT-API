<div class="page-container">
  <header class="page-header">
    <div class="header-info">
      <h1 class="page-title">People Directory</h1>
      <p class="page-desc">Manage residents, staff, and visitors in your community.</p>
    </div>
    <div class="header-actions">
      <p-button label="Add Person" icon="pi pi-plus" severity="success"></p-button>
    </div>
  </header>

  <div class="table-card">
    <div class="card-header">
      <div class="search-box">
        <i class="pi pi-search"></i>
        <input type="text" pInputText placeholder="Search by name or email..." class="table-search">
      </div>
      <div class="filter-actions">
        <p-button icon="pi pi-filter" [outlined]="true" severity="secondary"></p-button>
        <p-button icon="pi pi-refresh" [outlined]="true" severity="secondary"></p-button>
      </div>
    </div>

    <p-table [value]="(users$ | async) ?? []" [loading]="(loading$ | async) ?? false" 
             [tableStyle]="{'min-width': '60rem'}" 
             styleClass="p-datatable-gridlines-none">
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 30%">User</th>
          <th style="width: 25%">Email</th>
          <th style="width: 15%">Role</th>
          <th style="width: 15%">Status</th>
          <th style="width: 15%">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-user>
        <tr>
          <td>
            <div class="user-info-cell">
              <p-avatar label="{{user.firstName[0]}}" shape="circle" styleClass="user-avatar-green"></p-avatar>
              <div class="user-name-info">
                <span class="full-name">{{ user.firstName }} {{ user.lastName }}</span>
                <span class="role-sub">{{ getRoleName(user.role) }}</span>
              </div>
            </div>
          </td>
          <td class="email-text">{{ user.email }}</td>
          <td>
            <span class="role-pill">{{ getRoleName(user.role) }}</span>
          </td>
          <td>
            <div class="status-wrapper">
              <span class="dot" [ngClass]="{'active': user.isActive, 'inactive': !user.isActive}"></span>
              <span class="status-label">{{ user.isActive ? 'Active' : 'Inactive' }}</span>
            </div>
          </td>
          <td>
            <div class="action-buttons">
              <p-button icon="pi pi-pencil" [rounded]="true" [text]="true" severity="secondary" size="small" [routerLink]="['/users', user.id]"></p-button>
              <p-button icon="pi pi-trash" [rounded]="true" [text]="true" severity="danger" size="small" (onClick)="delete(user.id)"></p-button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="empty-msg">No users found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>